<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Pybonacci">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>Instalando PostgreSQL en local en windows o linux usando conda | Pybonacci</title>

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" title="Pybonacci blog atom feed" href="/feeds/all.atom.xml" />
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/theme/css/fontello.css"/>
        <style>.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #60a0b0; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.highlight .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #40a070 } /* Literal.Number */
.highlight .s { color: #4070a0 } /* Literal.String */
.highlight .na { color: #4070a0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60add5 } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287e } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #bb60d5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #40a070 } /* Literal.Number.Float */
.highlight .mh { color: #40a070 } /* Literal.Number.Hex */
.highlight .mi { color: #40a070 } /* Literal.Number.Integer */
.highlight .mo { color: #40a070 } /* Literal.Number.Oct */
.highlight .sb { color: #4070a0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070a0 } /* Literal.String.Char */
.highlight .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070a0 } /* Literal.String.Double */
.highlight .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070a0 } /* Literal.String.Heredoc */
.highlight .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #c65d09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070a0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #bb60d5 } /* Name.Variable.Class */
.highlight .vg { color: #bb60d5 } /* Name.Variable.Global */
.highlight .vi { color: #bb60d5 } /* Name.Variable.Instance */
.highlight .il { color: #40a070 } /* Literal.Number.Integer.Long */</style>
        <style>.description-author {
  font-size: 0.8em;
  color: #333;
}
.img-author {
  max-height: 10em;
  max-width: 10em;
}
img[src$="centerme"] {
  display: block;
  margin: 0 auto;
}
body {
  margin: 0;
  padding: 0;
  font: 15px 'Source Sans Pro', sans-serif;
  line-height: 1.6em;
  color: #222222;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}
a {
  color: #007ee5;
  text-decoration: none;
}
a:hover {
  color: #007ee5;
  text-decoration: none;
}
header.main-header {
  background: none repeat scroll 0% 0% #205F29;
  margin-bottom: 0px;
}
header.main-header a {
  color: #fff;
}
header.main-header .container {
  max-width: 1000px;
}
header.main-header .container nav a:hover {
  background-color: #5C881C;
}
header.navbar-default {
  border-bottom: none;
  background-color: #EFEFEF;
}
article {
  margin: 0;
}
article header.about {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
article header {
  padding-bottom: 20px;
}
article header h1 {
  margin-bottom: 2px;
  font-weight: 700;
  color: #000;
}
article header time {
  color: #9E9E9E;
  float: right;
}
article header time.left {
  color: #9E9E9E;
  float: left;
}
article div.social-links ul {
  padding: 0px;
}
article div.social-links li {
  display: inline;
  font-size: 20px;
}
article div.social-links li a {
  color: #000;
  padding: 10px;
}
article div.social-links li a:hover {
  color: #666;
  text-decoration: none;
}
article p {
  font-size: 2em;
  margin-bottom: 20px;
  line-height: 1.6em;
  text-align: justify;
}
article p.note {
  background: #f5f5f5;
  border: 1px solid #ddd;
  padding: 0.533em 0.733em;
}
article p.update {
  background-color: #FEEFB3;
  border: 1px solid #e6e68a;
  padding: 0.533em 0.733em;
}
article p.alert {
  background-color: #ffe2e2;
  border: 1px solid #ffb2b2;
  padding: 0.533em 0.733em;
}
article ul,
article ol {
  margin-top: 0px;
  margin-bottom: 25px;
}
article li {
  font-size: 16px;
  line-height: 1.6em;
}
article a:hover {
  text-decoration: underline;
}
article blockquote {
  border-left: 2px solid #c7c7cc;
  color: #666;
  margin: 30px 0;
  padding: 0 0 0 25px;
}
article img {
  max-width: 100%;
}
article code {
  color: #333;
  background-color: #EEE;
  border-radius: 0;
  font-size: 1.1em;
}
article .meta {
  margin-top: 35px;
}
article .meta a:hover {
  text-decoration: none;
}
article .meta div {
  display: block;
}
article .meta address:before,
article .meta time:before,
article .meta a.tag:before {
  font-family: 'fontello';
  margin-right: 6px;
}
article .meta address.author {
  float: left;
}
article .meta address:before {
  content: '\e819';
}
article .meta time:before {
  content: '\f133';
}
article .meta div.tags {
  clear: both;
}
article .meta a.tag {
  margin: 0 10px 10px 0;
  padding: 1px 12px;
  display: inline-block;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.8);
  background: rgba(0, 0, 0, 0.05);
}
article .meta a.tag:before {
  content: '\e821';
}
article .meta a.tag:hover {
  background: rgba(0, 0, 0, 0.15);
}
article .meta a.read_more,
article .meta a.comments_btn {
  font-size: 14px;
  font-weight: 800;
  padding: 10px 20px;
  color: #007aa3;
  background: #FFF;
  border: 1px solid #007aa3;
}
article .meta a.read_more:hover,
article .meta a.comments_btn:hover {
  color: #FFF;
  background: #007aa3;
}
article .meta:after {
  content: "";
  display: table;
  clear: both;
}
.index {
  max-width: 700px;
}
.index article header h2 {
  font-size: 36px;
  margin-bottom: 2px;
  font-weight: 700;
}
.index article header h2 a {
  color: #333;
}
.index article header h2 a:hover {
  color: #007ee5;
  text-decoration: none;
}
.index .separator {
  padding: 40px 0 0 0;
  margin: 0 0 40px 0;
  height: 10px;
  border-bottom: solid 1px #CCC;
}
.index .pagination {
  display: block;
  margin-bottom: 100px;
}
.index .pagination .left {
  text-align: right;
}
.index .pagination .right {
  text-align: left;
}
.index .pagination a {
  display: inline-block;
  border: 2px solid #5C881C;
  margin: 0 5px;
  padding: 8px 20px;
  font-weight: bold;
  color: #5C881C;
}
.index .pagination a:hover {
  color: #FFF;
  background: #5C881C;
}
.post {
  max-width: 80%;
}
.post h1 {
  font-size: 42px;
}
.post h2:before {
  content: "# ";
  font-weight: bold;
  color: #DDD;
}
.post h3:before {
  content: "## ";
  font-weight: bold;
  color: #DDD;
}
.post h4:before {
  content: "### ";
  font-weight: bold;
  color: #DDD;
}
.post p {
  font-size: 2em;
}
.post li {
  font-size: 2em;
}
.list {
  max-width: 700px;
}
.list ul.double-list {
  margin: 0 auto 60px;
  padding: 0;
  list-style-type: none;
}
.list ul.double-list li {
  padding: 5px 0;
}
.list ul.double-list li h2 {
  font-size: 2em;
  display: inline;
  font-weight: normal;
}
.list ul.double-list li span {
  font-family: sans-serif;
  text-transform: uppercase;
  text-align: right;
  float: right;
  padding-top: 3px;
  font-size: 12px;
  color: #999;
}
.full-width-content {
  padding-top: 10px;
  padding-left: 0px;
  padding-right: 0px;
  margin-left: -20px;
  margin-right: -20px;
}
.col-xs-1,
.col-sm-1,
.col-md-1,
.col-lg-1,
.col-xs-2,
.col-sm-2,
.col-md-2,
.col-lg-2,
.col-xs-3,
.col-sm-3,
.col-md-3,
.col-lg-3,
.col-xs-4,
.col-sm-4,
.col-md-4,
.col-lg-4,
.col-xs-5,
.col-sm-5,
.col-md-5,
.col-lg-5,
.col-xs-6,
.col-sm-6,
.col-md-6,
.col-lg-6,
.col-xs-7,
.col-sm-7,
.col-md-7,
.col-lg-7,
.col-xs-8,
.col-sm-8,
.col-md-8,
.col-lg-8,
.col-xs-9,
.col-sm-9,
.col-md-9,
.col-lg-9,
.col-xs-10,
.col-sm-10,
.col-md-10,
.col-lg-10,
.col-xs-11,
.col-sm-11,
.col-md-11,
.col-lg-11,
.col-xs-12,
.col-sm-12,
.col-md-12,
.col-lg-12 {
  padding-right: 0px;
  padding-left: 0px;
}
.disclaimer {
  text-align: center;
  background-color: #EFEFEF;
  border-bottom: none;
  margin-top: 6em;
}
pre {
  font-size: 1.2em;
}</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

       <script src="https://comments.pybonacci.org/assets/js/commento.js" data-div="#commento"></script>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
                processEscapes: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
        });
        MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
            for(i=0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>


        </script>

    </head>

    <body>
        <header class="navbar navbar-default bs-docs-nav">
            <div class="container-fluid">
                <div class="navbar-header">
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#theNavbar">
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span> 
		  </button>
                  <a class="navbar-brand" href="/" title="Home" class="title">Pybonacci</a><!-- — Python y Ciencia-->
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation" id="theNavbar">
		    <ul class="nav navbar-nav navbar-right">
                            <li><a href="/pages/acerca-de-pybonacci.html" title="About">Acerca de</a></li>
                            <li><a href="/archives.html" title="Archive">Archivos</a></li>
                            <li><a class="nodec icon-rss" href="/feeds/all.atom.xml" title="pybonacci.github.io RSS feed" rel="me"></a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1>Instalando PostgreSQL en local en windows o linux usando conda</h1>
            <div class="meta">
                <time datetime="article.date.isoformat()" pubdate>mar 25 julio 2017</time>
                <address class="vcard author">Por
                    <a class="url fn" href="http://pybonacci.github.io/author/kiario.html">kiario</a>
                </address>
            </div>
        </header>

        <div class="article_content">
            <p>Para el que no lo sepa, podéis instalar PostgreSQL usando <code>conda</code> \o/</p>
<p>Vamos a hacer un tutorial paso a paso para poder instalarlo todo y
dejarlo listo para trabajar desde Python de forma sencilla.</p>
<p><strong>[<em>A lo largo de todo el tutorial se indica si el código a usar es
para windows o para linux. Si no se indica nada el código debería ser
válido en ambos sistemas operativos.</em>]</strong></p>
<h1>1. Creamos un entorno virtual usando <code>conda</code> e instalamos PostgreSQL.</h1>
<p>Este paso es sencillo. Solo necesitáis tener instalado <code>conda</code> en
vuestro equipo y una conexión a internet. Si no tenéis <code>conda</code> instalado
podéis ir a la sección de enlaces, más abajo, para visitar la
documentación de <code>conda</code> donde os indica como instalarlo. Con <code>conda</code>
instalado, podemos añadir el canal de <code>conda-forge</code> (básico para poder
extender la cantidad de paquetes disponibles además de los mantenidos
oficialmente). Lo podéis añadir a vuestros canales de referencia
mediante el siguiente código a ejecutar en la línea de comandos:</p>
<p><code>conda config --add channels conda-forge</code></p>
<p>Una vez hecho lo anterior, en vuestra línea de comandos, podéis
escribir:</p>
<p><code>conda create --name pgenv postgresql python=3.6</code></p>
<p>Lo anterior nos crea un entorno virtual <code>conda</code> llamado <code>pgenv</code> con
Python 3.6. Activamos el nuevo entorno que hemos creado escribiendo en
la línea de comandos:</p>
<p><code>source activate pgenv</code> # linux</p>
<p><code>activate pgenv</code> # windows</p>
<p>Antes de poder usar PostgreSQL debemos hacer alguna cosita más. Veamos
la siguiente sección.</p>
<h1>2. Creando un cluster de BBDD</h1>
<p>Una vez instalado PostgreSQL deberéis crear la carpeta de datos donde se
guardarán las BBDD (a esto se le llama cluster en los docs de
PostgreSQL).</p>
<p>Lo vamos a instalar en una carpeta que se llame <strong><em>data</em></strong>. La carpeta
<strong><em>data</em></strong> la creará el comando si no existe pero fallará si ya existe y
no está vacía. Por ello, para evitar problemas podemos crear la carpeta
a mano donde deseemos para asegurarnos que la misma esté vacía y para
asegurarnos que tenemos permisos de escritura en esa ubicación.</p>
<p><code>mkdir /ruta/hasta/data</code> # linux<br>
<code>mkdir "C:\\ruta\\hasta\\data"</code> # windows.</p>
<p>En linux, ubicaciones populares de esta carpeta <strong><em>data</em></strong> son:</p>
<p><code>/usr/local/pgsql/data</code><br>
<code>/var/lib/pgsql/data</code></p>
<p>Pero la podéis colocar donde queráis.</p>
<p>Y ahora vamos al comando en cuestión. Si estáis en linux podéis hacer:</p>
<p><code>initdb -D /usr/local/pgsql/data</code> # linux</p>
<p>En windows es similar pero con una ruta aceptable para windows:</p>
<p><code>initdb -D "C:\\ruta\\hasta\\data"</code> # windows</p>
<p>De forma alternativa podéis hacer:</p>
<p><code>pg_ctl -D /usr/local/pgsql/data initdb</code> # linux</p>
<p><code>"pg_ctl" -D "C:\\ruta\\hasta\\data" initdb</code> # windows</p>
<p>Es mejor usar, en general, <code>pg_ctl</code> ya que es el comando que usaremos
para arrancar, parar,..., el servidor de BBDD por lo que será útil
familiarizarnos con el mismo.</p>
<h1>3. Arrancando el servidor de BBDD.</h1>
<p>Podemos arrancar el servidor de BBDD usando:</p>
<p><code>pg_ctl -D /usr/local/pgsql/data start</code> # linux</p>
<p><code>"pg_ctl" -D "C:\\ruta\\hasta\\data" start</code> # windows</p>
<p>Si, además, queremos tener un fichero <strong><em>log</em></strong> con la información de lo
que se vaya<br>
haciendo podemos usar la opción <code>-l</code>:</p>
<p><code>pg_ctl -D /usr/local/pgsql/data -l fichero_log start</code> # linux</p>
<p><code>"pg_ctl" -D "C:\\ruta\\hasta\\data" -l fichero_log start</code> # windows</p>
<p>Y se creará un fichero de texto con la información llamado
<strong><em>fichero_log</em></strong> en la<br>
ubicación desde donde lanzamos el comando (o en la ruta que defináis si
así queréis). Es recomendable usar esta opción si no queréis que toda la
información se vaya mostrando en la línea de comandos y para tener un
registro de lo que vamos haciendo.</p>
<p>El directorio de datos se crea con seguridad mínima (modo <strong><em>trust</em></strong>).
Como vamos a trabajar en local y, generalmente, en un sistema
monousuario o con usuarios en los que confiamos no vamos a prestar mucha
atención a esto pero puedes leer más sobre ello
<a href="https://www.postgresql.org/docs/current/static/auth-methods.html">aquí</a>.</p>
<p>El usuario por defecto del sistema que hace la instalación de PostgreSQL
(usando <code>conda</code> en este caso) es el que se puede usar para la base de
datos.</p>
<h1>4. Interactuando con la base de datos.</h1>
<p>Podemos instalar también <code>psycopg2</code>, driver para comunicar Python con
PostgreSQL, y <code>pgcli</code>, una línea de comandos con esteroides, lo que
viene a ser IPython para la consola Python. Con nuestro entorno <code>pgenv</code>
activado escribimos en la línea de comandos:</p>
<p><code>conda install pgcli psycopg2</code></p>
<p>Genial, ¡qué fácil todo!</p>
<p>Vamos a crear nuestra primera base de datos. Para ello deberemos tener
el servidor de BBDD funcionando. En este caso, con el comando que hemos
usado anteriormente, <code>pg_ctl ... start</code>, debería haber arrancado y lo
siguiente debería funcionar sin dar problemas:</p>
<p><code>createdb dbtest</code></p>
<p>Lo anterior debería haber creado una base de datos llamada <strong><em>dbtest</em></strong>.
Si no ha<br>
habido ningún problema podríamos acceder con <code>pgcli</code> (o <code>psql</code>, el
comando de serie que viene con PostgreSQL) haciendo:</p>
<p><code>pgcli dbtest</code> # 'psql dbtest' en caso que no hayáis instalado pgcli</p>
<p>(si hemos entrado en <code>pgcli</code> o en <code>psql</code> podemos salir usando <code>\q</code>).</p>
<p>Ahora podríamos empezar a crear tablas e insertar datos pero, si os
acordáis, hemos instalado <code>psycopg2</code>. Usémoslo para hacerlo desde
Python.</p>
<p>El siguiente código va a crear una tabla llamada <code>tabla</code> y vamos a
insertar una serie de filas. Lo podéis ejecutar desde la consola Python
mismo:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psycopg2</span>

<span class="c1"># tu_usuario en la siguiente línea debería ser tu usuario del sistema</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;dbname=dbtest user=tu_usuario&quot;</span><span class="p">)</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="s2">&quot;CREATE TABLE tabla (id serial PRIMARY KEY, num integer, num_txt varchar);&quot;</span>
<span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="s2">&quot;INSERT INTO tabla (num, num_txt) VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> 
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;uno&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="s2">&quot;INSERT INTO tabla (num, num_txt) VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;diez&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>


<p>Lo que hace el código anterior es, básicamente:</p>
<ul>
<li>se conecta a la base de datos que acabamos de crear, <strong><em>dbtest</em></strong>,</li>
<li>crea una tabla, llamada 'tabla',</li>
<li>mete varias filas de datos en esa nueva tabla y,</li>
<li>finalmente, cierra la conexión con la base de datos.</li>
</ul>
<p>Desde la línea de comandos podemos usar <code>pgcli</code> para hacer una consulta,
también desde python pero vamos a hacerlo con <code>pgcli</code> en este caso:</p>
<p>(salid de la consola Python usando <code>exit()</code> si todavía estáis dentro de
la misma)</p>
<p>En la línea de comandos:</p>
<p><code>pgcli dbtest</code> # 'psql dbtest' si no habéis instalado pgcli</p>
<p>Ya dentro de <code>pgcli</code> (o <code>psql</code>) podemos hacer una consulta SQL:</p>
<div class="highlight"><pre><span></span>SELECT * FROM tabla
</pre></div>


<p>Y nos debería dar el siguiente resultado:</p>
<div class="highlight"><pre><span></span>+------+-------+-----------+
|  id  |  num  |  num_txt  |
|------+-------+-----------|
|   1  |   1   |    uno    |
|   2  |   10  |    diez   |
+------+-------+-----------+
SELECT 2
Time: 0.008s
</pre></div>


<p>Salimos nuevamente de <code>pgcli</code> (o <code>psql</code>) usando:</p>
<p><code>\q</code></p>
<h1>5. Administración y limpieza.</h1>
<p>Si no queréis la base de datos y la deseáis eliminar podéis usar, desde
la línea de comandos:</p>
<p><code>dropdb dbtest</code></p>
<p>Y la base de datos se borrará.</p>
<p>Vamos a apagar el servidor PostgreSQL para ver como se hace:</p>
<p><code>pg_ctl -D /usr/local/pgsql/data stop</code> # linux</p>
<p><code>"pg_ctl" -D "C:\\ruta\\hasta\\data" stop</code> # windows</p>
<p>Si lo quisiéramos volver a arrancar podemos hacer:</p>
<p><code>pg_ctl -D /usr/local/pgsql/data start</code> # linux</p>
<p><code>"pg_ctl" -D "C:\\ruta\\hasta\\data" start</code> # windows</p>
<p>Podéis ver las diferentes opciones del comando <code>pg_ctl</code> mediante:</p>
<p><code>pg_ctl --help</code></p>
<p>Y eso es todo. Una forma sencilla de usar PostgreSQL en local mediante
<code>conda</code>.</p>
<h1>6. Eliminar el entorno virtual y PostgreSQL de forma eficaz.</h1>
<p>Eliminarlo todo sería tan sencillo como eliminar el entorno <code>conda</code>
creado una vez que lo tengamos desactivado y que el servidor de BBDD
este parado.</p>
<p>Para parar el servidor de BBDD hacemos en la línea de comandos:</p>
<p><code>pg_ctl -D /usr/local/pgsql/data stop</code> # linux</p>
<p><code>"pg_ctl" -D "C:\\ruta\\hasta\\data" stop</code> # windows</p>
<p>Para desactivar el entorno virtual hacemos desde la línea de comandos</p>
<p><code>source deactivate</code> # linux</p>
<p><code>deactivate</code> # windows</p>
<p>Y para borrar el entorno virtual <code>pgenv</code> hacemos, desde la línea de
comandos:</p>
<p><code>conda-env remove --name pgenv</code></p>
<p>Si, además, queremos hacer limpieza general de <code>conda</code>, limpiar paquetes
'cacheados' y liberar espacio en disco podemos hacer desde la linea de
comandos:</p>
<p><code>conda clean -pt</code></p>
<p>Finalmente, borramos la carpeta <strong><em>data</em></strong> que creamos al principio de
esta entrada.</p>
<p><code>rm -fr /usr/local/pgsql/data</code> # linux</p>
<p><code>rmdir "C:\\ruta\\hasta\\data" /s /q</code> # windows</p>
<h1>Enlaces.</h1>
<p>Página oficial de Postgresql: <a href="https://www.postgresql.org/">https://www.postgresql.org/</a><br>
Documentación oficial de Postgresql: <a href="https://www.postgresql.org/docs/">https://www.postgresql.org/docs/</a><br>
Documentación oficial de conda: <a href="https://conda.io/docs/">https://conda.io/docs/</a><br>
Por si queréis cambiar el usuario y/o password que usa conda en la
instalación:
<a href="https://stackoverflow.com/questions/15008204/how-to-check-postgres-user-and-password#15008311">https://stackoverflow.com/questions/15008204/how-to-check-postgres-user-and-password#15008311</a><br>
Documentación oficial de psycopg2:
<a href="http://initd.org/psycopg/docs/index.html">http://initd.org/psycopg/docs/index.html</a><br>
Página oficial de pgcli: <a href="https://www.pgcli.com/">https://www.pgcli.com/</a></p>
<h1>Notas finales.</h1>
<p>No se entra en profundidad en ninguna de las herramientas (PostgreSQL,
pgcli, psycopg2) para mantener el tutorial lo más sencillo posible.</p>
<p>En los enlaces tenéis mucha más información para ampliar.</p>
<p>En ningún caso se presta atención al tema de seguridad, configuración en
profundidad,..., de PostgreSQL ya que eso daría para unas cuantas
entradas.</p>
<p>¡¡Disfruten lo instalado!!</p>
        </div>

        <div class="meta">
            <div class="tags">
                    <a href="http://pybonacci.github.io/tag/base-de-datos.html" class="tag">base de datos</a>
                    <a href="http://pybonacci.github.io/tag/bases-de-datos.html" class="tag">bases de datos</a>
                    <a href="http://pybonacci.github.io/tag/bbdd.html" class="tag">bbdd</a>
                    <a href="http://pybonacci.github.io/tag/conda.html" class="tag">conda</a>
                    <a href="http://pybonacci.github.io/tag/conda-forge.html" class="tag">conda-forge</a>
                    <a href="http://pybonacci.github.io/tag/pgcli.html" class="tag">pgcli</a>
                    <a href="http://pybonacci.github.io/tag/postgresql.html" class="tag">postgresql</a>
                    <a href="http://pybonacci.github.io/tag/psycopg2.html" class="tag">psycopg2</a>
            </div>
        </div>


    </article>
<div id="commento"></div>
</div>

<style type="text/css">
{
    max-width: 700px;
}

.text_cell .prompt {
    display: none;
}

div.cell {
    padding: 0;
}

div.text_cell_render {
    padding: 0;
}

div.prompt {
    font-size: 13px;
}

div.input_prompt {
    padding: .7em 0.2em;
}

div.output_prompt {
    padding: .4em .2em;
}

div.input_area {
    margin: .2em 0.4em;
    max-width: 580px;
}

table.dataframe {
    font-family: Arial, sans-serif;
    font-size: 13px;
    line-height: 20px;
}

table.dataframe th, td {
    padding: 4px;
    text-align: left;
}

pre code {
    background-color: inherit;
}</style>

        </div>

        <footer class="disclaimer">
          <div class="container-fluid">
            <p>
              © 2012-2017 Pybonacci, licencia <a href="https://github.com/Pybonacci/pybonacci.github.io/blob/sources/LICENSE.md"> CC BY-SA 4.0 + MIT</a>
              salvo otra indicación.
              <p>Contenido generado con <a href= "http://docs.getpelican.com/">Pelican</a>.</p>
            </p>
          </div>
        </footer>

    </body>
</html>